# GRU
**Global Rolling Updater** (GRU) — это система автоматического обновления, набор спецификаций и общие принципы развёртывания. Известным проектом, использующим GRU, является [Tor Portable](https://github.com/Verity-Freedom/Tor-Portable).

1. Программа, придерживающаяся GRU, хранит себя через архив по постоянной, неутрачиваемой ссылке. Форматы архивов для GRU должны быть широкоизвестными и кроссплатформенными, вроде .zip. В зависимости от конкретной реализации способ не утратить ссылку может быть различным, одним из них является сохранение названия архива без изменений (IPNS).
2. Текущая версия программы может быть указана через специальный файл (для примера назовём его VERSION) внутри самого архива, в её интерфейсе, в свойствах бинарных файлов, в директории с архивами. Рекомендуется помещать его в директорию с архивами и в сами архивы, так как это даёт наибольшее количество информации как для глаз пользователя, так и для программы. Возможна реализация автообновления по принципу сравнения файлов VERSION внутри архива и в директории с архивами.
3. Программа, размещённая по системе GRU, не хранит историю версий по актуальной ссылке, вместо этого всегда указывая на последнюю из них. Это делает удобным сокрытие предыдущих версий и невозможным их случайное скачивание. В случае с IPNS предыдущие версии могут сохраниться в файловой системе.
4. Само автоматическое обновление происходит по схеме: 1) перевод директории на текущую; 2) удаление всех файлов и директорий в папке с копированием пользовательских; 3) скачивание архива; 4) распаковка архива; 5) удаление архива и всех оставшихся лишних файлов. Реализации на Windows и Linux отличаются: Linux хранит исполняемый скрипт в оперативной памяти и делает возможным его горячее удаление, в отличие от Windows. Поэтому на Windows необходимо создание второго скрипта, который возьмёт на себя работу после удаления первого.
5. На Linux эталонным детерменированным развёртыванием является использование портативных библиотек через `./ld-linux-x86-64.so.2 --library-path .`, что позволяет запускаться любым программам в идентичной среде, независимо от дистрибутива. GRU допускает молниеносные обновления как самой программы, так и портативных библиотек, их необходимо использовать ради унификации пользовательского опыта при потребности.

На этом описание спецификаций GRU закончено.

## Особенности GRU
1. Универсальность. Не требуется установки никаких отдельных программ для соблюдения всех спецификаций. Принципы системы могут быть совместимы со множеством файловых хранилищ (проверены IPNS и Google Drive).
2. Заложенный в архитектуру rolling-release гарантирует, что пользователь получит только последнюю версию приложения, избегая устаревающих ссылок.
3. Поддержка автообновлений начиная с Windows 7 и на любых Linux системах. Любой файл автообновления имеет крайне небольшой размер и при этом генерирует уже распакованную программу по щелчку, что позволяет избегать ограничений на передачу файлов большого размера.
4. Сохранение битов исполнения и любых метаданных в распакованных файлах, в отличие от, например, git-clone.
5. Возможность передачи любых видов информации, включая постоянно пополняемых коллекций изображений и музыки.
